# Hosting packages.sshsync.io

This guide describes how to configure a Linux server to host the Debian and RPM
repositories generated by the release workflow.

1. **Install required packages**
   ```bash
   sudo apt-get update
   sudo apt-get install -y nginx gnupg createrepo dpkg-dev
   ```

2. **Create repository directories**
   ```bash
   sudo mkdir -p /var/www/packages/deb /var/www/packages/rpm
   sudo chown $USER /var/www/packages/deb /var/www/packages/rpm
   ```

3. **Expose the repositories with Nginx**
   Create `/etc/nginx/sites-available/packages.conf`:
   ```nginx
   server {
       listen 80;
       server_name packages.sshsync.io;
       root /var/www/packages;
       autoindex on;
   }
   ```
   Enable the site and reload Nginx:
   ```bash
   sudo ln -s /etc/nginx/sites-available/packages.conf /etc/nginx/sites-enabled/packages.conf
   sudo nginx -t && sudo systemctl reload nginx
   ```

4. **Import the GPG key** used by the workflow to sign repository metadata.
   The public key should be exported from the CI secrets:
   ```bash
   gpg --import ssh-sync.pub
   ```

5. **Configure SSH access** for the GitHub Actions runner. Create a user and add
   its public key to `~/.ssh/authorized_keys`.

6. **Update DNS** so that `packages.sshsync.io` points to this server.

Once these steps are complete, each tagged release will synchronize the `repo/`
directory to `/var/www/packages` using rsync over SSH.

